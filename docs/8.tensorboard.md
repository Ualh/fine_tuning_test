# TensorBoard monitoring (port 6006)

This stage explains how to collect live training metrics with TensorBoard while running the finetune stage in the Docker-based pipeline.

## Prerequisites

- The `tensorboard` Python package ships with the `sft` image through `requirements.txt`.
- The Docker Compose stack now exposes a dedicated `tensorboard` service that tails the shared `logs/` directory.
- The finetune configuration enables TensorBoard logging by default (`train.report_to: ["tensorboard"]`).

## Start TensorBoard

Use the wrapper to launch the dashboard:

```powershell
docker compose build tensorboard   # only needed the first time
run_pipeline.bat tensorboard-up
```

This starts TensorBoard on `http://localhost:6006`. The service binds to `0.0.0.0`, so machines on the same network can access it via the host IP (e.g. `http://<host-ip>:6006`).

## Fine-tune with live metrics

When you run the finetune stage, event files are written under the per-run directory `logs/log_vXX_.../train/tensorboard/`. The wrapper prints the active logdir:

```powershell
run_pipeline.bat finetune-sft
```

You should see lines similar to:

```
[FINETUNE] TensorBoard=http://localhost:6006 (logdir=logs/log_v12_2025-10-28_10-39-14/train/tensorboard)
```

Keep TensorBoard running to follow step metrics, learning rates, and evaluation curves as they stream in.

## Stopping and troubleshooting

```powershell
run_pipeline.bat tensorboard-logs  # Tail container logs (Ctrl+C to exit)
run_pipeline.bat tensorboard-down  # Stop the TensorBoard container
```

If no runs appear:

- Confirm the finetune stage completed at least one logging step (`train.logging_steps` in `config.yaml`).
- Check that `train.report_to` contains `tensorboard` and `train.logging_dir` is either `null` or points inside the project.
- Verify event files exist: `ls logs/log_v*/train/tensorboard/*.tfevents*` inside the repo or container.

For remote access, ensure port 6006 is open on the host firewall. The service only reads from the shared `logs/` volume; no data is written back to outputs.
